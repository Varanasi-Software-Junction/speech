<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Synthetic Speak — Dashboard with Drawer and Avatars</title>
<style>
  :root{--bg:#f6f8fb;--blue:#0b78d1;--orange:#f97316;--muted:#64748b}
  *{box-sizing:border-box;margin:0;padding:0}
  body{background:var(--bg);font-family:Inter,system-ui,Arial,sans-serif;color:#0b1220;display:flex;flex-direction:column;min-height:100vh}

  header{background:#fff;padding:12px 18px;box-shadow:0 4px 12px rgba(0,0,0,0.06);display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand{font-weight:800;font-size:18px;color:var(--blue)}
  .icon-btn{background:transparent;border:0;padding:8px;border-radius:8px;cursor:pointer}

  .container{display:grid;grid-template-columns:1fr;gap:14px;padding:14px;flex:1;align-items:start}
  .dashboard{display:grid;grid-template-columns:260px 1fr 260px;gap:14px}

  aside{background:white;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.06);padding:14px;overflow:auto}
  .btn{padding:10px;border:none;border-radius:8px;cursor:pointer;font-weight:700;color:#fff}
  .primary{background:var(--blue)}
  .warn{background:#ffb020}
  .success{background:#059669}
  .danger{background:#ef4444}

  .voice-select{width:100%;padding:8px;border:1px solid #e6eefc;border-radius:8px}
  .rate{width:100%}

  .avatars{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
  .avatar{width:110px;height:110px;border-radius:50%;overflow:hidden}

  .main-content{display:flex;flex-direction:column;gap:14px}
  .slide{background:#fff;border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);display:flex;gap:12px;align-items:center}
  .thumb{width:120px;height:80px;border-radius:8px;background:#e2e8f0}
  .slide-text{font-weight:700}
  .dialogue-box{background:#fff;border-radius:12px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,0.06);display:flex;flex-direction:column;gap:8px}
  .speaker{font-weight:800;color:var(--blue)}

  footer{background:#fff;box-shadow:0 -4px 12px rgba(0,0,0,0.06);padding:10px;display:flex;align-items:center;justify-content:center;gap:10px}

  .drawer-backdrop{position:fixed;inset:0;background:rgba(3,7,18,0.35);opacity:0;visibility:hidden;transition:opacity .2s ease;z-index:120}
  .drawer-backdrop.open{opacity:1;visibility:visible}
  .drawer{position:fixed;top:0;left:-320px;width:320px;height:100vh;background:#fff;box-shadow:4px 0 24px rgba(2,6,23,0.12);transition:left .28s ease;z-index:130;padding:18px;overflow:auto}
  .drawer.open{left:0}
  .drawer h3{margin-bottom:8px}

  .mini-widget{position:fixed;top:12px;right:12px;width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--blue),#60a5fa);display:flex;align-items:center;justify-content:center;color:white;font-weight:800;box-shadow:0 6px 20px rgba(2,6,23,0.18);z-index:200;visibility:hidden;opacity:0;transform:translateY(-6px);transition:all .2s ease}
  .mini-widget.show{visibility:visible;opacity:1;transform:translateY(0)}
  .mini-widget button{background:transparent;border:0;color:white;font-weight:800;cursor:pointer}

  @media(max-width:980px){.dashboard{grid-template-columns:1fr}aside.right{order:3}}
</style>
</head>
<body>
<header>
  <div style="display:flex;gap:12px;align-items:center">
    <button id="openDrawerBtn" class="icon-btn" title="Open drawer">☰</button>
    <div class="brand">Synthetic Speak — Teaching Dashboard</div>
  </div>
  <button id="collapseBtn" class="icon-btn" title="Collapse">⬇︎</button>
</header>

<div class="drawer-backdrop" id="drawerBackdrop"></div>
<aside class="drawer" id="drawer">
  <h3>Voice Controls</h3>
  <label>Teacher Voice<select id="teacherVoiceSelect" class="voice-select"></select></label>
  <label>Teacher Rate<input id="teacherRate" type="range" min="0.6" max="1.5" step="0.05" value="1" class="rate"></label>
  <hr>
  <label>Student Voice<select id="studentVoiceSelect" class="voice-select"></select></label>
  <label>Student Rate<input id="studentRate" type="range" min="0.6" max="1.5" step="0.05" value="1" class="rate"></label>
  <button id="drawerCloseBtn" class="btn primary" style="margin-top:12px">Done</button>
</aside>

<div class="mini-widget" id="miniWidget"><button id="restoreBtn">⇪</button></div>

<div class="container">
  <div class="dashboard" id="dashboard">
    <main class="main-content" id="mainContent">
      <div class="avatars">
        <svg id="teacherAvatar" class="avatar" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="tGrad" x1="0" x2="1"><stop offset="0" stop-color="#0b78d1"/><stop offset="1" stop-color="#60a5fa"/></linearGradient></defs><rect width="120" height="120" rx="60" fill="url(#tGrad)"/><circle cx="60" cy="38" r="18" fill="#fff"/><g class="mouth" transform="translate(60,65)"><ellipse cx="0" cy="0" rx="12" ry="4" fill="#0b1220"/></g></svg>
        <svg id="studentAvatar" class="avatar" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="sGrad" x1="0" x2="1"><stop offset="0" stop-color="#f97316"/><stop offset="1" stop-color="#fb923c"/></linearGradient></defs><rect width="120" height="120" rx="60" fill="url(#sGrad)"/><circle cx="60" cy="38" r="18" fill="#fff"/><g class="mouth" transform="translate(60,65)"><ellipse cx="0" cy="0" rx="12" ry="4" fill="#fff" stroke="#0b1220" stroke-width="1.4"/></g></svg>
      </div>
      <div class="slide" id="slideTop"><div class="thumb" id="slideTopThumb"></div><div class="slide-text" id="slideTopText">(previous slide)</div></div>
      <div class="slide" id="slideBottom"><div class="thumb" id="slideBottomThumb"></div><div class="slide-text" id="slideBottomText">(current slide)</div></div>
      <div class="dialogue-box" id="dialogueBox"><div id="currentSpeaker" class="speaker"></div><div id="currentDialogue">Click Play to start</div></div>
    </main>
    <aside class="right" id="rightPanel"><h4>Slide History</h4><div id="history" style="display:flex;flex-direction:column;gap:8px"></div></aside>
  </div>
</div>

<footer>
  <button id="playBtn" class="btn primary">Play</button>
  <button id="pauseBtn" class="btn warn">Pause</button>
  <button id="resumeBtn" class="btn success">Resume</button>
  <button id="stopBtn" class="btn danger">Stop</button>
</footer>

<textarea id="dialoguesText" style="display:none">Teacher: Welcome to today's class.
Student: Hello, I'm ready.
Teacher: We'll discuss data structures.
Student: Sounds great, let's go.
Teacher: First, arrays are contiguous collections.
Student: Okay, I understand the basics now.</textarea>

<script>
const openDrawerBtn=document.getElementById('openDrawerBtn');
const drawer=document.getElementById('drawer');
const drawerBackdrop=document.getElementById('drawerBackdrop');
const drawerCloseBtn=document.getElementById('drawerCloseBtn');
const collapseBtn=document.getElementById('collapseBtn');
const miniWidget=document.getElementById('miniWidget');
const restoreBtn=document.getElementById('restoreBtn');
const teacherVoiceSelect=document.getElementById('teacherVoiceSelect');
const studentVoiceSelect=document.getElementById('studentVoiceSelect');
const teacherRate=document.getElementById('teacherRate');
const studentRate=document.getElementById('studentRate');
const playBtn=document.getElementById('playBtn');
const pauseBtn=document.getElementById('pauseBtn');
const resumeBtn=document.getElementById('resumeBtn');
const stopBtn=document.getElementById('stopBtn');
const slideTopText=document.getElementById('slideTopText');
const slideBottomText=document.getElementById('slideBottomText');
const slideTopThumb=document.getElementById('slideTopThumb');
const slideBottomThumb=document.getElementById('slideBottomThumb');
const historyEl=document.getElementById('history');
const currentSpeaker=document.getElementById('currentSpeaker');
const currentDialogue=document.getElementById('currentDialogue');
const teacherAvatar=document.getElementById('teacherAvatar');
const studentAvatar=document.getElementById('studentAvatar');

openDrawerBtn.onclick=()=>{drawer.classList.add('open');drawerBackdrop.classList.add('open');};
drawerBackdrop.onclick=()=>{drawer.classList.remove('open');drawerBackdrop.classList.remove('open');};
drawerCloseBtn.onclick=()=>{drawer.classList.remove('open');drawerBackdrop.classList.remove('open');};
collapseBtn.onclick=()=>{document.getElementById('dashboard').style.display='none';miniWidget.classList.add('show');};
restoreBtn.onclick=()=>{document.getElementById('dashboard').style.display='grid';miniWidget.classList.remove('show');};

const thumbs=[];for(let i=0;i<8;i++)thumbs.push(`<svg viewBox='0 0 120 80' xmlns='http://www.w3.org/2000/svg'><rect width='120' height='80' rx='8' fill='hsl(${i*40},80%,90%)'/><circle cx='36' cy='40' r='18' fill='hsl(${i*40},60%,50%)'/></svg>`);
let tIndex=0;function nextThumb(){return thumbs[tIndex++%thumbs.length];}
slideTopThumb.innerHTML=nextThumb();slideBottomThumb.innerHTML=nextThumb();

let voices=[];function populateVoices(){voices=speechSynthesis.getVoices();teacherVoiceSelect.innerHTML='';studentVoiceSelect.innerHTML='';voices.forEach(v=>{teacherVoiceSelect.add(new Option(v.name,v.name));studentVoiceSelect.add(new Option(v.name,v.name));});if(voices.length){teacherVoiceSelect.value=voices[0].name;studentVoiceSelect.value=voices[Math.min(1,voices.length-1)].name;}}speechSynthesis.onvoiceschanged=populateVoices;setTimeout(populateVoices,300);

function parseDialogues(){const raw=document.getElementById('dialoguesText').value||'';return raw.split('\n').map(l=>l.trim()).filter(Boolean).map(l=>{const m=l.match(/^(Teacher|Student):\s*(.*)/i);if(m)return{role:m[1].toLowerCase(),text:m[2]};return{role:'teacher',text:l};});}

function pushSlide(line){slideTopText.textContent=slideBottomText.textContent;slideTopThumb.innerHTML=slideBottomThumb.innerHTML;slideBottomText.textContent=line.text;slideBottomThumb.innerHTML=nextThumb();const row=document.createElement('div');row.textContent=`${line.role.toUpperCase()}: ${line.text}`;historyEl.prepend(row);}

function animateMouth(avatar){const mouth=avatar.querySelector('.mouth ellipse');let scale=1;return setInterval(()=>{scale=scale===1?1.3:1;mouth.setAttribute('transform',`scale(1,${scale})`);},200);} 

function speakLine(line){return new Promise(res=>{const u=new SpeechSynthesisUtterance(line.text);const v=(line.role==='teacher'?teacherVoiceSelect.value:studentVoiceSelect.value);const vc=voices.find(x=>x.name===v);if(vc)u.voice=vc;u.rate=(line.role==='teacher'?parseFloat(teacherRate.value):parseFloat(studentRate.value));let anim;
u.onstart=()=>{currentSpeaker.textContent=line.role==='teacher'?'Teacher:':'Student:';currentDialogue.textContent=line.text;pushSlide(line);const avatar=line.role==='teacher'?teacherAvatar:studentAvatar;anim=animateMouth(avatar);};
u.onend=()=>{clearInterval(anim);const avatar=line.role==='teacher'?teacherAvatar:studentAvatar;avatar.querySelector('.mouth ellipse').setAttribute('transform','scale(1,1)');setTimeout(res,150);};speechSynthesis.speak(u);});}

let paused=false,stopped=false;
async function playAll(){if(speechSynthesis.speaking)speechSynthesis.cancel();paused=false;stopped=false;const lines=parseDialogues();for(const l of lines){if(stopped)break;await speakLine(l);while(paused&&!stopped){await new Promise(r=>setTimeout(r,150));}}if(!stopped)currentDialogue.textContent='All dialogues finished.';}

playBtn.onclick=()=>{stopped=false;paused=false;playAll();};pauseBtn.onclick=()=>{if(speechSynthesis.speaking){speechSynthesis.pause();paused=true;}};resumeBtn.onclick=()=>{if(paused){speechSynthesis.resume();paused=false;}};stopBtn.onclick=()=>{speechSynthesis.cancel();stopped=true;paused=false;currentDialogue.textContent='Stopped.';};
</script>
</body>
</html>
